{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"About the Authors Kyle Dawson Kyle BIO Jeff Imholz Jeff BIO Dave Krier Dave has over 25 years of IT industry experience with deep skills in solution architecture, application development, and infrastructure management. He is an accomplished technical specialist who has traveled around the nation consulting with IBM\u2019s most successful customers.","title":"Home"},{"location":"#about-the-authors","text":"","title":"About the Authors"},{"location":"#kyle-dawson","text":"Kyle BIO","title":"Kyle Dawson"},{"location":"#jeff-imholz","text":"Jeff BIO","title":"Jeff Imholz"},{"location":"#dave-krier","text":"Dave has over 25 years of IT industry experience with deep skills in solution architecture, application development, and infrastructure management. He is an accomplished technical specialist who has traveled around the nation consulting with IBM\u2019s most successful customers.","title":"Dave Krier"},{"location":"Bring-Your-Own-VPC/","text":"","title":"Bring your own VPC"},{"location":"DNS-Networking/","text":"","title":"DNS Networking"},{"location":"Enabling-Certs/","text":"","title":"Enabling Certs"},{"location":"IPI-Step-by-Step/","text":"","title":"IPI Install step by step"},{"location":"MQ-RDQM-Install/","text":"Deploying MQ RDQM with Floating IP Address on VSphere Download Instructions This is the instructions for deploying RDQM and configuring a HA Queue Manager with floating ip address. Requirements Platform: VSphere 6.7 3 Virtual Machines VM OS: RHEL 9.2 Need a second disk 100 GB on all 3 VM\u2019s 2 CPU x 16GB of Mem Public IP Address Software: IBM MQ 9.3.0.2 Download the software from IBM\u2019s Internal DSW Downloads Site Software XL Sites of Interest https://www.ibm.com/docs/en/ibm-mq/9.3?topic=configurations-rdqm-high-availability https://www.royalcyber.com/blog/middleware/high-availability-of-replicated-data-queue-manager/ Preparing for RDQM https://www.ibm.com/docs/en/ibm-mq/9.3?topic=configurations-rdqm-high-availability https://community.ibm.com/community/user/integration/blogs/prema-laxmanachar1/2022/08/10/detailed-procedure-of-migrating-regular-ibm-mq-que https://www.ibm.com/docs/en/ibm-mq/9.3?topic=availability-requirements-rdqm-ha-solution https://www.redhat.com/sysadmin/create-physical-volume General Commands that were of use during my attempts to install yum upgrade yum update yum update kernel hostnamectl <-- Verify Kernel version matches on all 3 machines. Installing RDQM Documentation 1. Provision 3 (2CPU x 16GB mem) machines in VSphere Uncheck the \"SECURE BOOT\" option for all 3 VM's Minimum requirements are 2CPU x 16GB of Mem Add an extra 100GB disk 2. Install packages (on all 3 boxes) sudo yum -y install libxslt net-snmp-libs nfs-utils nfs-utils-coreos perl-TimeDate python3-lxml python-unversioned-command 3. SCP the install file (to all three servers) scp <file>@<ipaddress of target>:<location on target to place file> EXAMPLE: scp ./IBM_MQ_9.3.0.2_LINUX_X86-64.tar.gz bastion@10.67.42.177:/home/bastion/ 4. Untar the file (on all 3 servers) tar -xvf IBM_MQ_9.3.0.2_LINUX_X86-64.tar.gz 5. Install kernal NOTE: I ran into issues when trying to use the drbd kernel that is provided with the IBM MQ 9.3.0.2 download. I had to download a NEWER one because the RHEL OS was at a higher version than what was expected. Look on this page for a download for RHEL 9.2 Kernal to match the OS Interim kernel module releases https://www.ibm.com/support/pages/ibm-mq-replicated-data-queue-manager-kernel-modules#LTS9_2 \u2022 https://www.ibm.com/support/fixcentral/swg/downloadFixes?parent=ibm%2FWebSphere&product=ibm/WebSphere/WebSphere+MQ&release=All&platform=All&function=fixId&fixids=9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14&includeRequisites=1&includeSupersedes=0&downloadMethod=http&source=SAR THIS IS THE FILE I USED: interim fix: 9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14 Steps to install (On all 3 machines) wget https://ak-delivery04-mul.dhe.ibm.com/sdfdl/v2/sar/CM/WS/0bfrk/0/Xa.2/Xb.jusyLTSp44S03o2r0ALI9rdnHzZDQ4Pdhenqod7cCfzE79MnOWh_uumEiKA/Xc.CM/WS/0bfrk/0/9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14.tgz/Xd./Xf.LPR.D1VK/Xg.12320491/Xi.habanero/XY.habanero/XZ.toSiALXjCZMNaORuZis7fBS2qXvKsM_3/9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14.tgz tar -xvf 9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14.tgz cd 9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14 yum install ./yum install ./kmod-drbd-9.1.14+ptf.2_5.14.0_284.11.1-1.x86_64.rpm 6. Install DRBD Utils yum install /home/bastion/MQServer/Advanced/RDQM/PreReqs/el9/drbd-utils-9/* 7. Install Pacemaker yum install /home/bastion/MQServer/Advanced/RDQM/PreReqs/el9/pacemaker-2/* 8. Accept the license /home/bastion/MQServer/mqlicense.sh 9. Install MQ cd /home/bastion/MQServer yum install MQSeriesGSKit* MQSeriesServer* MQSeriesRuntime* 10. Install RDQM cd /home/bastion/MQServer yum install Advanced/RDQM/MQSeriesRDQM* Preparing VM\u2019s for setup of RDQM Useful Commands: pvscan pvs pvcreate pvdisplay cfdisk lvmdiskscan Setup the disk volume group for DRBD Do this on all 3 VM\u2019s Find the disk device.. In my case it was /dev/sbd ls /dev/sd* Create the PV pvcreate /dev/sdb Create the Volume Group vgcreate drbdpool /dev/sdb Setup Passwordless SSH Login on all 3 VM\u2019s https://www.ibm.com/docs/en/ibm-mq/9.2?topic=solution-setting-up-passwordless-ssh usermod -d /home/mqm mqm mkhomedir_helper mqm Set the password passwd mqm su mqm ssh-keygen -t rsa -f /home/mqm/.ssh/id_rsa -N '' Copy Keys to all 3 VM's ssh-copy-id -i /home/mqm/.ssh/id_rsa.pub <ip address VM1> ssh-copy-id -i /home/mqm/.ssh/id_rsa.pub <ip address VM2> ssh-copy-id -i /home/mqm/.ssh/id_rsa.pub <ip address VM3> verify.. On each VM you can access without password ssh <ip address VM1>uname -n ssh <ip address VM2>uname -n ssh <ip address VM3>uname -n NOTE : You may be prompted for fingerprint the first time, so you NEED to TEST. Do on all machines Exit out of mqm user exit Switch to root user su passwd -d mqm passwd -l mqm Add mqm user to sudo file Run this command on all three servers and make the following edits. visudo ADD THE FOLLLOWING LINE BELOW THIS COMMENT ## Allows people in group wheel to run all commands #%mqm ALL=(ALL) ALL ADD THE FOLLLOWING LINE BELOW THIS COMMENT ## Same thing without a password %mqm ALL=(ALL) NOPASSWD: ALL Configure SELINUX Security NOTE : Run these commands on all machines as ROOT semanage permissive -a drbd_t /opt/mqm/samp/rdqm/firewalld/configure.sh Setup local dns NOTE : Run these commands on all machines as ROOT vi /etc/hosts ADD THIS TO THE FILE <ip address VM1> qm1 <ip address VM2> qm2 <ip address VM3> qm3 Configure RDMQ INI File NOTE : Run these commands on all machines as ROOT vi /var/mqm/rdqm.ini EDIT FILE LIKE THIS Node: Name=qm1 HA_Replication=10.67.42.177 HA_Primary=10.67.42.177 # HA_Alternate= # DR_Replication=10.67.42.177 Node: Name=qm2 HA_Replication=10.67.42.155 HA_Primary=10.67.42.155 # HA_Alternate= # DR_Replication=10.67.42.155 Node: Name=qm3 HA_Replication=10.67.42.153 HA_Primary=10.67.42.153 # HA_Alternate= # DR_Replication=10.67.42.153 Configure Pacemaker group /opt/mqm/bin/rdqmadm -c Configure NEW RDQM QueueManager /opt/mqm/bin/crtmqm -sx qmgrdk1 /opt/mqm/bin/crtmqm -sxs -fs 3072M qmgrdk1","title":"RDQM HA Install"},{"location":"MQ-RDQM-Install/#deploying-mq-rdqm-with-floating-ip-address-on-vsphere","text":"Download Instructions This is the instructions for deploying RDQM and configuring a HA Queue Manager with floating ip address.","title":"Deploying MQ RDQM with Floating IP Address on VSphere"},{"location":"MQ-RDQM-Install/#requirements","text":"Platform: VSphere 6.7 3 Virtual Machines VM OS: RHEL 9.2 Need a second disk 100 GB on all 3 VM\u2019s 2 CPU x 16GB of Mem Public IP Address Software: IBM MQ 9.3.0.2 Download the software from IBM\u2019s Internal DSW Downloads Site Software XL","title":"Requirements"},{"location":"MQ-RDQM-Install/#sites-of-interest","text":"https://www.ibm.com/docs/en/ibm-mq/9.3?topic=configurations-rdqm-high-availability https://www.royalcyber.com/blog/middleware/high-availability-of-replicated-data-queue-manager/ Preparing for RDQM https://www.ibm.com/docs/en/ibm-mq/9.3?topic=configurations-rdqm-high-availability https://community.ibm.com/community/user/integration/blogs/prema-laxmanachar1/2022/08/10/detailed-procedure-of-migrating-regular-ibm-mq-que https://www.ibm.com/docs/en/ibm-mq/9.3?topic=availability-requirements-rdqm-ha-solution https://www.redhat.com/sysadmin/create-physical-volume","title":"Sites of Interest"},{"location":"MQ-RDQM-Install/#general-commands-that-were-of-use-during-my-attempts-to-install","text":"yum upgrade yum update yum update kernel hostnamectl <-- Verify Kernel version matches on all 3 machines.","title":"General Commands that were of use during my attempts to install"},{"location":"MQ-RDQM-Install/#installing-rdqm","text":"Documentation 1. Provision 3 (2CPU x 16GB mem) machines in VSphere Uncheck the \"SECURE BOOT\" option for all 3 VM's Minimum requirements are 2CPU x 16GB of Mem Add an extra 100GB disk 2. Install packages (on all 3 boxes) sudo yum -y install libxslt net-snmp-libs nfs-utils nfs-utils-coreos perl-TimeDate python3-lxml python-unversioned-command 3. SCP the install file (to all three servers) scp <file>@<ipaddress of target>:<location on target to place file> EXAMPLE: scp ./IBM_MQ_9.3.0.2_LINUX_X86-64.tar.gz bastion@10.67.42.177:/home/bastion/ 4. Untar the file (on all 3 servers) tar -xvf IBM_MQ_9.3.0.2_LINUX_X86-64.tar.gz 5. Install kernal NOTE: I ran into issues when trying to use the drbd kernel that is provided with the IBM MQ 9.3.0.2 download. I had to download a NEWER one because the RHEL OS was at a higher version than what was expected. Look on this page for a download for RHEL 9.2 Kernal to match the OS Interim kernel module releases https://www.ibm.com/support/pages/ibm-mq-replicated-data-queue-manager-kernel-modules#LTS9_2 \u2022 https://www.ibm.com/support/fixcentral/swg/downloadFixes?parent=ibm%2FWebSphere&product=ibm/WebSphere/WebSphere+MQ&release=All&platform=All&function=fixId&fixids=9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14&includeRequisites=1&includeSupersedes=0&downloadMethod=http&source=SAR THIS IS THE FILE I USED: interim fix: 9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14 Steps to install (On all 3 machines) wget https://ak-delivery04-mul.dhe.ibm.com/sdfdl/v2/sar/CM/WS/0bfrk/0/Xa.2/Xb.jusyLTSp44S03o2r0ALI9rdnHzZDQ4Pdhenqod7cCfzE79MnOWh_uumEiKA/Xc.CM/WS/0bfrk/0/9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14.tgz/Xd./Xf.LPR.D1VK/Xg.12320491/Xi.habanero/XY.habanero/XZ.toSiALXjCZMNaORuZis7fBS2qXvKsM_3/9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14.tgz tar -xvf 9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14.tgz cd 9-IBM-MQ-LAIT43724-kmod-drbd-9.1.14 yum install ./yum install ./kmod-drbd-9.1.14+ptf.2_5.14.0_284.11.1-1.x86_64.rpm 6. Install DRBD Utils yum install /home/bastion/MQServer/Advanced/RDQM/PreReqs/el9/drbd-utils-9/* 7. Install Pacemaker yum install /home/bastion/MQServer/Advanced/RDQM/PreReqs/el9/pacemaker-2/* 8. Accept the license /home/bastion/MQServer/mqlicense.sh 9. Install MQ cd /home/bastion/MQServer yum install MQSeriesGSKit* MQSeriesServer* MQSeriesRuntime* 10. Install RDQM cd /home/bastion/MQServer yum install Advanced/RDQM/MQSeriesRDQM*","title":"Installing RDQM"},{"location":"MQ-RDQM-Install/#preparing-vms-for-setup-of-rdqm","text":"Useful Commands: pvscan pvs pvcreate pvdisplay cfdisk lvmdiskscan Setup the disk volume group for DRBD Do this on all 3 VM\u2019s Find the disk device.. In my case it was /dev/sbd ls /dev/sd* Create the PV pvcreate /dev/sdb Create the Volume Group vgcreate drbdpool /dev/sdb","title":"Preparing VM\u2019s for setup of RDQM"},{"location":"MQ-RDQM-Install/#setup-passwordless-ssh-login-on-all-3-vms","text":"https://www.ibm.com/docs/en/ibm-mq/9.2?topic=solution-setting-up-passwordless-ssh usermod -d /home/mqm mqm mkhomedir_helper mqm Set the password passwd mqm su mqm ssh-keygen -t rsa -f /home/mqm/.ssh/id_rsa -N '' Copy Keys to all 3 VM's ssh-copy-id -i /home/mqm/.ssh/id_rsa.pub <ip address VM1> ssh-copy-id -i /home/mqm/.ssh/id_rsa.pub <ip address VM2> ssh-copy-id -i /home/mqm/.ssh/id_rsa.pub <ip address VM3> verify.. On each VM you can access without password ssh <ip address VM1>uname -n ssh <ip address VM2>uname -n ssh <ip address VM3>uname -n NOTE : You may be prompted for fingerprint the first time, so you NEED to TEST. Do on all machines Exit out of mqm user exit Switch to root user su passwd -d mqm passwd -l mqm","title":"Setup Passwordless SSH Login on all 3 VM\u2019s"},{"location":"MQ-RDQM-Install/#add-mqm-user-to-sudo-file","text":"Run this command on all three servers and make the following edits. visudo ADD THE FOLLLOWING LINE BELOW THIS COMMENT ## Allows people in group wheel to run all commands #%mqm ALL=(ALL) ALL ADD THE FOLLLOWING LINE BELOW THIS COMMENT ## Same thing without a password %mqm ALL=(ALL) NOPASSWD: ALL","title":"Add mqm user to sudo file"},{"location":"MQ-RDQM-Install/#configure-selinux-security","text":"NOTE : Run these commands on all machines as ROOT semanage permissive -a drbd_t /opt/mqm/samp/rdqm/firewalld/configure.sh","title":"Configure SELINUX Security"},{"location":"MQ-RDQM-Install/#setup-local-dns","text":"NOTE : Run these commands on all machines as ROOT vi /etc/hosts ADD THIS TO THE FILE <ip address VM1> qm1 <ip address VM2> qm2 <ip address VM3> qm3","title":"Setup local dns"},{"location":"MQ-RDQM-Install/#configure-rdmq-ini-file","text":"NOTE : Run these commands on all machines as ROOT vi /var/mqm/rdqm.ini EDIT FILE LIKE THIS Node: Name=qm1 HA_Replication=10.67.42.177 HA_Primary=10.67.42.177 # HA_Alternate= # DR_Replication=10.67.42.177 Node: Name=qm2 HA_Replication=10.67.42.155 HA_Primary=10.67.42.155 # HA_Alternate= # DR_Replication=10.67.42.155 Node: Name=qm3 HA_Replication=10.67.42.153 HA_Primary=10.67.42.153 # HA_Alternate= # DR_Replication=10.67.42.153","title":"Configure RDMQ INI File"},{"location":"MQ-RDQM-Install/#configure-pacemaker-group","text":"/opt/mqm/bin/rdqmadm -c","title":"Configure Pacemaker group"},{"location":"MQ-RDQM-Install/#configure-new-rdqm-queuemanager","text":"/opt/mqm/bin/crtmqm -sx qmgrdk1 /opt/mqm/bin/crtmqm -sxs -fs 3072M qmgrdk1","title":"Configure NEW RDQM QueueManager"},{"location":"Troubleshooting-Install/","text":"","title":"Troubleshooting Install"},{"location":"mkdocs-setup/","text":"","title":"Setup MKDocs"},{"location":"skills-needed/","text":"","title":"Skills Needed for Install"}]}